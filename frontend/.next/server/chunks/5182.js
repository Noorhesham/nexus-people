"use strict";exports.id=5182,exports.ids=[5182],exports.modules={27957:(e,a,s)=>{s.a(e,async(e,d)=>{try{s.d(a,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var r=s(20997),n=s(13126),i=s(19),t=s.n(i),o=s(39564),l=s.n(o),m=s(45634),c=s.n(m),h=s(16689),x=s(67934),u=s.n(x),w=s(37730),p=s.n(w),g=s(33103),j=s.n(g),b=s(77749),f=s.n(b),v=s(50773),P=s.n(v),F=s(64488),M=s.n(F),y=s(68891),C=s.n(y),_=s(60911),N=s.n(_),E=s(79475),k=s(86096),D=s.n(k),S=s(85074),q=s.n(S),A=s(99648),O=s(69915),W=s(35443),T=s(2296),B=s(75609),U=s(27163),Z=s.n(U),z=s(73646),R=s.n(z),$=e([A,O,W]);[A,O,W]=$.then?(await $)():$;let __WEBPACK_DEFAULT_EXPORT__=({open:e,close:a,apiEndPoint:s})=>{let{isRTL:d}=(0,h.useContext)(E.O),[i,o]=(0,h.useState)(!1),{user:m,logout:x}=(0,h.useContext)(W.V),[w,g]=(0,h.useState)(!1),{formatMessage:b}=(0,n.useIntl)(),[v,F]=(0,h.useState)({oldPassword:"",newPassword:"",repeat_password:""}),y=B.object({oldPassword:B.string().required(b({id:"required.password"})),newPassword:B.string().required(b({id:"required.password"})).min(8,b({id:"password.min.length"})).matches(/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]/,b({id:"password.requirements"})).notOneOf([B.ref("oldPassword"),null],b({id:"newPassword.same.as.old"})),repeat_password:B.string().required(b({id:"required.password"})).oneOf([B.ref("newPassword")],b({id:"passwords.must.match"}))}),ChangePassword=async(e,{resetForm:a})=>{y.validate(e).then(async()=>{try{await A.default.put(`${s}`,v,{headers:{token:O.default.get("token")}}).then(()=>{x(O.default.get("token"),!1),F({oldPassword:"",newPassword:"",repeat_password:""}),closeEditPassword()})}catch(e){}})},closeEditPassword=()=>{o(!1)},handleClickShowPassword=()=>g(e=>!e),handleMouseDownPassword=e=>{e.preventDefault()};return r.jsx(l(),{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:e,onClose:a,closeAfterTransition:!0,slots:{backdrop:q()},slotProps:{backdrop:{timeout:500}},children:r.jsx(c(),{in:e,children:(0,r.jsxs)(t(),{className:"space-y-8",sx:I,children:[r.jsx("div",{className:"flex mb-8 flex-row-reverse w-60 sm:w-full ",children:r.jsx(M(),{className:"relative right-0 hover:text-primary cursor-pointer",onClick:a})}),r.jsx("div",{className:"flex justify-center space-y-2",children:r.jsx(R(),{variant:"fullWidth",className:"w-full",children:r.jsx(Z(),{variant:"h6",children:r.jsx(n.FormattedMessage,{id:"form.changePassword"})})})}),r.jsx(T.Formik,{initialValues:v,validationSchema:y,onSubmit:ChangePassword,children:({isValid:e,dirty:a})=>(0,r.jsxs)(T.Form,{dir:d?"rtl":"ltr",className:"w-60 sm:w-96 space-y-4",children:[(0,r.jsxs)(C(),{variant:"outlined",className:"w-full",children:[r.jsx(N(),{htmlFor:"oldPassword",children:r.jsx(n.FormattedMessage,{id:"form.current"})}),r.jsx(T.Field,{name:"oldPassword",children:({field:e,meta:a})=>r.jsx(p(),{id:"oldPassword",type:w?"text":"password",...e,onChange:a=>{e?.onChange(a),F(e=>({...e,oldPassword:a.target.value}))},endAdornment:r.jsx(j(),{position:"end",children:r.jsx(u(),{"aria-label":"toggle password visibility",onClick:handleClickShowPassword,onMouseDown:handleMouseDownPassword,edge:"end",children:w?r.jsx(f(),{}):r.jsx(P(),{})})}),label:r.jsx(n.FormattedMessage,{id:"form.current"})})}),r.jsx(T.ErrorMessage,{name:"oldPassword",component:"div",className:"text-red-500"})]}),(0,r.jsxs)(C(),{variant:"outlined",className:"w-full",children:[r.jsx(N(),{htmlFor:"newPassword",children:r.jsx(n.FormattedMessage,{id:"form.new"})}),r.jsx(T.Field,{name:"newPassword",children:({field:e,meta:a})=>r.jsx(p(),{id:"newPassword",type:w?"text":"password",...e,onChange:a=>{e?.onChange(a),F(e=>({...e,newPassword:a.target.value}))},endAdornment:r.jsx(j(),{position:"end",children:r.jsx(u(),{"aria-label":"toggle password visibility",onClick:handleClickShowPassword,onMouseDown:handleMouseDownPassword,edge:"end",children:w?r.jsx(f(),{}):r.jsx(P(),{})})}),label:r.jsx(n.FormattedMessage,{id:"form.new"})})}),r.jsx(T.ErrorMessage,{name:"newPassword",component:"div",className:"text-red-500"})]}),(0,r.jsxs)(C(),{variant:"outlined",className:"w-full",children:[r.jsx(N(),{htmlFor:"repeat_password",children:r.jsx(n.FormattedMessage,{id:"form.confirm"})}),r.jsx(T.Field,{name:"repeat_password",children:({field:e,meta:a})=>r.jsx(p(),{id:"repeat_password",type:w?"text":"password",...e,onChange:a=>{e?.onChange(a),F(e=>({...e,repeat_password:a.target.value}))},endAdornment:r.jsx(j(),{position:"end",children:r.jsx(u(),{"aria-label":"toggle password visibility",onClick:handleClickShowPassword,onMouseDown:handleMouseDownPassword,edge:"end",children:w?r.jsx(f(),{}):r.jsx(P(),{})})}),label:r.jsx(n.FormattedMessage,{id:"form.confirm"})})}),r.jsx(T.ErrorMessage,{name:"repeat_password",component:"div",className:"text-red-500"})]}),r.jsx(D(),{type:"submit",variant:"contained",className:"bg-secondary w-full text-white hover:bg-primary py-2",disabled:!e||!a,children:r.jsx(n.FormattedMessage,{id:"form.changePassword"})})]})})]})})})},I={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",borderRadius:"20px",bgcolor:"background.paper",boxShadow:24,p:4};d()}catch(e){d(e)}})},85182:(e,a,s)=>{s.a(e,async(e,d)=>{try{s.r(a),s.d(a,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=s(20997),n=s(10298),i=s(85753),t=s(91856),o=s(86096),l=s.n(o),m=s(7988),c=s.n(m),h=s(67934),x=s.n(h),u=s(37730),w=s.n(u),p=s(33103),g=s.n(p),j=s(77749),b=s.n(j),f=s(50773),v=s.n(f),P=s(68891),F=s.n(P),M=s(60911),y=s.n(M),C=s(42651),_=s.n(C),N=s(16689),E=s(29271),k=s.n(E),D=s(79475),S=s(13126),q=s(32216),A=s(69915),O=s(2296),W=s(75609),T=s(99648),B=s(1635),U=s.n(B),Z=s(27957),z=s(35443),R=e([q,A,T,Z,z]);[q,A,T,Z,z]=R.then?(await R)():R;let __WEBPACK_DEFAULT_EXPORT__=({render:e,ProfileData:a,apiEndpoint:s,HandleModal:d})=>{let{isRTL:o}=(0,N.useContext)(D.O),[m,h]=(0,N.useState)(!1),[u,p]=(0,N.useState)(!1),[j,f]=(0,N.useState)(!1),{user:P,fetchUser:M,updateUser:C}=(0,N.useContext)(z.V),{formatMessage:E}=(0,S.useIntl)(),B=W.object({name:W.object().shape({en:W.string().min(5,E({id:"name.short"})).required(E({id:"required.nameEn"})),ar:W.string().min(5,E({id:"name.short"})).required(E({id:"required.nameAr"}))}),gender:W.string().required(E({id:"required.gender"})),DOB:W.date().required(E({id:"required.dob"})),email:W.string().email(E({id:"contact.email.invalid"})).required(E({id:"contact.email.error"})),phone:W.string().required(E({id:"required.phone"})),password:W.string().required(E({id:"required.password"})).min(8,E({id:"password.min"})).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/,E({id:"password.complexity"})),address:W.string().required(E({id:"required.address"}))}),{handleSubmit:R,handleInputChange:$,handleEdit:I}=(0,q.Z)({apiEndpoint:"https://nexusbhub.com/backend/"}),handleClickShowPassword=()=>p(e=>!e),handleMouseDownPassword=e=>{e.preventDefault()},handleSubmitData=async(e,{resetForm:a})=>{try{let a=await T.default.post("https://nexusbhub.com/backend/auth/admin/checkEmail",{email:e.email});"User already exists"===a.data.Error?f(!0):a.data.exists||(await B.validate(e),await R(s,!1,A.default.get("token")).then(()=>{f(!1),d()}))}catch(e){console.error("Validation error:",e)}};(0,N.useEffect)(()=>{P?.role!=="admin"&&I(P?._id)},[]);let handleUpdateData=async()=>{await I(P?._id).then(async()=>{await R(`https://nexusbhub.com/backend/${P?.role}`,!1,A.default.get("token")).then(()=>{M(A.default.get("token"))})})};return(0,r.jsxs)("div",{dir:o?"rtl":"ltr",className:"space-y-4 min-h-96",children:[e&&P?.provider==="System"?r.jsx("div",{className:"w-full flex justify-end",children:r.jsx(l(),{onClick:()=>{h(!0)},className:"bg-primary",variant:"contained",children:r.jsx(S.FormattedMessage,{id:"form.changePassword"})})}):null,r.jsx(O.Formik,{validateOnMount:!0,enableReinitialize:!0,initialValues:a||{},validationSchema:B,onSubmit:handleSubmitData,children:({isValid:s,dirty:d,setFieldValue:o,resetForm:m})=>(0,r.jsxs)(O.Form,{className:"gap-4 md:grid-cols-2 grid w-full",children:[r.jsx(O.Field,{name:"name[en]",children:({field:e,meta:s})=>(0,r.jsxs)("div",{children:[r.jsx(c(),{label:r.jsx(S.FormattedMessage,{id:"form.name"}),variant:"outlined",fullWidth:!0,...e,disabled:!!a&&P?.role==="admin",onChange:a=>{e.onChange(a),$("name.en",a.target.value,!1)}}),r.jsx(O.ErrorMessage,{name:"name[en]",component:"div",className:"text-red-500"})]})}),r.jsx(O.Field,{name:"name[ar]",children:({field:e,meta:s})=>(0,r.jsxs)("div",{children:[r.jsx(c(),{label:r.jsx(S.FormattedMessage,{id:"form.arabicName"}),variant:"outlined",fullWidth:!0,...e,disabled:!!a&&P?.role==="admin",onChange:a=>{e.onChange(a),$("name.ar",a.target.value,!1)}}),r.jsx(O.ErrorMessage,{name:"name[ar]",component:"div",className:"text-red-500"})]})}),(0,r.jsxs)(F(),{fullWidth:!0,children:[r.jsx(y(),{id:"demo-simple-select-label",children:r.jsx(S.FormattedMessage,{id:"form.gender"})}),r.jsx(O.Field,{name:"gender",children:({field:e})=>(0,r.jsxs)(_(),{labelId:"demo-simple-select-label",id:"demo-simple-select",label:r.jsx(S.FormattedMessage,{id:"form.gender"}),...e,disabled:!!a&&P?.role==="admin",onChange:a=>{e.onChange(a),$("gender",a.target.value,!1)},children:[r.jsx(k(),{value:"male",children:r.jsx(S.FormattedMessage,{id:"form.male"})}),r.jsx(k(),{value:"female",children:r.jsx(S.FormattedMessage,{id:"form.female"})})]})}),r.jsx(O.ErrorMessage,{name:"gender",component:"div",className:"text-red-500"})]}),r.jsx(i.LocalizationProvider,{dateAdapter:n.AdapterDayjs,children:r.jsx(O.Field,{type:"date",name:"DOB",component:t.DatePicker,children:({field:e})=>r.jsx(t.DatePicker,{format:"DD/MM/YYYY",label:r.jsx(S.FormattedMessage,{id:"form.dob"}),className:"w-full",disableFuture:!0,disabled:!!a&&P?.role==="admin",onChange:e=>{o("DOB",U()(e).toISOString()),$("DOB",U()(e).toISOString(),!1)}})})}),r.jsx(O.Field,{name:"email",children:({field:e,meta:s})=>(0,r.jsxs)("div",{children:[r.jsx(c(),{label:r.jsx(S.FormattedMessage,{id:"form.email"}),variant:"outlined",fullWidth:!0,...e,disabled:!!a&&P?.role==="admin",onChange:a=>{e.onChange(a),$("email",a.target.value,!1)}}),r.jsx(O.ErrorMessage,{name:"email",component:"div",className:"text-red-500"}),j?r.jsx("div",{className:"text-red-500",children:"Email Already exists"}):null]})}),r.jsx(O.Field,{name:"phone",children:({field:e,meta:s})=>(0,r.jsxs)("div",{children:[r.jsx(c(),{label:r.jsx(S.FormattedMessage,{id:"form.phone"}),variant:"outlined",fullWidth:!0,...e,disabled:!!a&&P?.role==="admin",onChange:a=>{e.onChange(a),$("phone",a.target.value,!1)}}),r.jsx(O.ErrorMessage,{name:"phone",component:"div",className:"text-red-500"})]})}),r.jsx(O.Field,{name:"address",children:({field:e,meta:s})=>(0,r.jsxs)("div",{children:[r.jsx(c(),{label:r.jsx(S.FormattedMessage,{id:"form.address"}),variant:"outlined",fullWidth:!0,...e,disabled:!!a&&P?.role==="admin",onChange:a=>{e.onChange(a),$("address",a.target.value,!1)}}),r.jsx(O.ErrorMessage,{name:"address",component:"div",className:"text-red-500"})]})}),e?r.jsx(r.Fragment,{children:r.jsx(l(),{onClick:e=>handleUpdateData(),disabled:!s||!d,variant:"contained",className:"bg-secondary md:col-span-2 text-white hover:bg-primary py-2",children:r.jsx(S.FormattedMessage,{id:"form.updateProfile"})})}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)(F(),{variant:"outlined",className:"w-full",children:[r.jsx(y(),{htmlFor:"outlined-adornment-password",children:r.jsx(S.FormattedMessage,{id:"form.password"})}),r.jsx(O.Field,{name:"password",children:({field:e,meta:a})=>(0,r.jsxs)("div",{children:[r.jsx(w(),{id:"outlined-adornment-password",className:"w-full",...e,onChange:a=>{e.onChange(a),$("password",a.target.value,!1)},type:u?"text":"password",endAdornment:r.jsx(g(),{position:"end",children:r.jsx(x(),{"aria-label":"toggle password visibility",onClick:handleClickShowPassword,onMouseDown:handleMouseDownPassword,edge:"end",children:u?r.jsx(b(),{}):r.jsx(v(),{})})}),label:r.jsx(S.FormattedMessage,{id:"form.password"})}),r.jsx(O.ErrorMessage,{name:"password",component:"div",className:"text-red-500"})]})})]}),r.jsx(l(),{variant:"contained",className:"bg-primary w-full",type:"submit",disabled:!s,children:r.jsx(S.FormattedMessage,{id:"admin.new"})})]})]})}),m?r.jsx(Z.Z,{open:m,close:()=>{h(!1)},apiEndPoint:s}):null]})};d()}catch(e){d(e)}})}};